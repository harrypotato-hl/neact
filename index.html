<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEACT | Friendship Never Ends</title>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;600;800&family=Quicksand:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Leaflet CSS for the Map -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <style>
        :root {
            /* Theme Variables - Default (Light) */
            --primary: #FFA500;
            --primary-light: #FFB732;
            --primary-dark: #E69500;
            --cream: #FFFDF5;
            --yellow-soft: #FFF9E6;
            --coffee: #6F4E37;
            --coffee-light: #8d6e63;
            --peach: #FFDAB9;
            --text-dark: #2A2525;
            --text-muted: #5a4a42;
            --white: #ffffff;
            
            /* Glassmorphism Variables */
            --glass-bg: rgba(255, 255, 255, 0.65);
            --glass-border: rgba(255, 255, 255, 0.8);
            --glass-bg-dark: rgba(255, 253, 245, 0.95);
            --nav-bg: rgba(255, 253, 245, 0.9);
            
            /* Overlays */
            --hero-overlay-rgb: 255, 253, 245;
            --footer-overlay: rgba(111, 78, 55, 0.92);
            --footer-overlay-deep: rgba(111, 78, 55, 0.96);
            --footer-text: #ffffff; 
            
            --transition-smooth: all 0.6s cubic-bezier(0.16, 1, 0.3, 1);
            --z-bg: -2;
            --z-assets: -1;
            --z-content: 1;
            --z-nav: 1000;
            --z-cursor: 20000; 
        }

        /* Dark Mode Overrides */
        body.dark-mode {
            --cream: #0c0b0a;
            --white: #1a1816;
            --yellow-soft: #25221e;
            --text-dark: #fcfcfc;
            --text-muted: #d1c1ba;
            --coffee: #e5d1c0;
            --coffee-light: #bc9c78;
            --peach: #3d2b1f;
            --glass-bg: rgba(30, 28, 26, 0.7);
            --glass-border: rgba(255, 165, 0, 0.2);
            --glass-bg-dark: rgba(12, 11, 10, 0.92);
            --nav-bg: rgba(12, 11, 10, 0.9);
            --hero-overlay-rgb: 12, 11, 10;
            --footer-overlay: rgba(12, 11, 10, 0.95);
            --footer-overlay-deep: rgba(0, 0, 0, 0.98);
            --footer-text: #e0e0e0; 
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            cursor: none; 
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Quicksand', sans-serif;
            background-color: var(--cream);
            color: var(--text-dark);
            overflow-x: hidden;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            transition: background-color 0.5s ease, color 0.5s ease;
        }

        /* --- Custom Cursor --- */
        #cursor {
            width: 20px;
            height: 20px;
            background: var(--primary);
            border-radius: 50%;
            position: fixed;
            pointer-events: none;
            z-index: var(--z-cursor);
            transition: transform 0.1s linear, width 0.3s ease, height 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            box-shadow: 0 0 20px var(--primary-light);
            mix-blend-mode: difference; 
        }

        h1, h2, h3, .brand-name {
            font-family: 'Lexend', sans-serif;
            font-weight: 800;
            letter-spacing: -0.03em;
        }

        /* --- Animations --- */
        .reveal { 
            opacity: 0; 
            transform: translateY(40px) scale(0.98); 
            filter: blur(5px);
            transition: var(--transition-smooth); 
        }
        .reveal.active { 
            opacity: 1; 
            transform: translateY(0) scale(1); 
            filter: blur(0);
        }

        /* --- Background Floating Assets --- */
        #bg-assets-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: var(--z-assets);
            overflow: hidden;
        }

        .floating-asset {
            position: absolute;
            opacity: 0.12;
            font-size: 2.5rem;
            filter: blur(1px);
            transition: transform 0.2s ease-out;
            will-change: transform;
        }

        /* --- Navigation --- */
        nav {
            position: fixed;
            top: 0;
            width: 100%;
            z-index: var(--z-nav);
            padding: 20px 0;
            background: var(--nav-bg);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border-bottom: 1px solid var(--glass-border);
            transition: padding 0.3s ease;
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 5%;
        }

        .logo-box {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            font-size: 1.6rem;
            color: var(--text-dark);
            transition: transform 0.2s ease-out;
        }
        .logo-box:active { transform: scale(0.95); }
        .logo-box.spin { animation: logo-spin 0.8s ease; }
        @keyframes logo-spin {
            0% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.2); }
            100% { transform: rotate(360deg) scale(1); }
        }

        .brand-name { color: var(--primary); }

        .nav-links {
            display: flex;
            gap: 35px;
            list-style: none;
            align-items: center;
        }

        .nav-links a {
            text-decoration: none;
            color: var(--text-dark);
            font-size: 0.95rem;
            font-weight: 700;
            opacity: 0.8;
            transition: 0.3s;
            letter-spacing: 0.02em;
        }
        .nav-links a:hover { opacity: 1; color: var(--primary); transform: translateY(-2px); }

        .magnetic {
            display: inline-block;
            transition: transform 0.2s ease-out;
        }

        .theme-toggle {
            background: var(--yellow-soft);
            border: 1px solid var(--glass-border);
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            cursor: none;
            transition: background 0.3s, transform 0.2s ease-out;
            margin-left: 15px;
        }
        .theme-toggle:hover { background: var(--primary); color: white; }

        .mobile-toggle { display: none; color: var(--primary); cursor: pointer; z-index: 1001; }

        /* --- Global Section Styles --- */
        section, footer {
            scroll-snap-align: start;
            position: relative;
            z-index: var(--z-content);
        }

        /* --- Hero Section --- */
        #hero {
            height: 100vh;
            min-height: 700px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 0 20px;
            background: linear-gradient(
                rgba(var(--hero-overlay-rgb), var(--hero-overlay-start, 0.5)), 
                rgba(var(--hero-overlay-rgb), var(--hero-overlay-end, 0.85))
            ), 
            url('https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?auto=format&fit=crop&q=80&w=2000');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            overflow: hidden;
        }

        body.dark-mode #hero {
            --hero-overlay-start: 0.65;
            --hero-overlay-end: 0.95;
        }

        .hero-badge {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            color: var(--primary-dark);
            padding: 10px 24px;
            border-radius: 100px;
            font-weight: 800;
            font-size: 0.85rem;
            margin-bottom: 24px;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        .hero-title { 
            font-size: clamp(3rem, 10vw, 7rem); 
            line-height: 1; 
            color: var(--text-dark); 
            margin-bottom: 25px;
            text-shadow: 0 10px 40px rgba(0,0,0,0.08);
        }
        .hero-title span { color: var(--primary); display: block; }

        .hero-sub { 
            font-size: clamp(1.1rem, 2.5vw, 1.6rem); 
            color: var(--text-dark); 
            max-width: 800px; 
            margin-bottom: 45px; 
            font-weight: 600; 
            line-height: 1.5;
            opacity: 0.9;
        }
        body.dark-mode .hero-sub { color: var(--text-muted); }

        .btn-main {
            background: var(--primary);
            color: white;
            padding: 20px 50px;
            border-radius: 100px;
            text-decoration: none;
            font-weight: 800;
            font-size: 1.1rem;
            box-shadow: 0 15px 40px rgba(255, 165, 0, 0.3);
            display: inline-flex;
            align-items: center;
            gap: 12px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .btn-main:hover { transform: translateY(-3px); box-shadow: 0 20px 50px rgba(255, 165, 0, 0.4); }

        /* --- Cinematic Timeline Section --- */
        #history { 
            padding: 0; 
            background: #000; 
            overflow: hidden; 
            z-index: var(--z-content);
            transition: background 0.5s ease;
        }
        
        body.dark-mode #history {
            background: linear-gradient(to bottom, #0c0b0a, #1a1816);
        }

        .history-intro { 
            height: 100vh;
            min-height: 600px;
            padding: 0 5%; 
            background: var(--cream); 
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            border-bottom: 1px solid var(--glass-border);
            transition: background 0.5s ease;
        }

        body.dark-mode .history-intro {
            background: linear-gradient(to bottom, #0c0b0a 0%, #151311 100%);
            border-bottom-color: rgba(255, 165, 0, 0.1);
        }

        .section-title { font-size: clamp(2.5rem, 6vw, 4.5rem); margin-bottom: 10px; color: var(--text-dark); }
        .section-sub { font-size: 1.2rem; font-weight: 600; color: var(--coffee-light); text-transform: uppercase; letter-spacing: 0.1em; }

        .story-container { position: relative; }

        .scene {
            height: 100vh;
            width: 100%;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: flex-start;
            padding: 0 12%;
            overflow: hidden;
            scroll-snap-align: start;
        }

        .scene-bg {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background-size: cover;
            background-position: center;
            z-index: 1;
            transform: scale(1.1);
            transition: transform 2.5s ease-out;
        }
        .scene.active .scene-bg { transform: scale(1); }

        .scene-overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 2;
        }
        
        /* Optimized for Readability */
        body.light-mode .scene-overlay {
            background: linear-gradient(90deg, rgba(255, 253, 245, 0.98) 0%, rgba(255, 253, 245, 0.8) 40%, transparent 100%);
        }

        body.dark-mode .scene-overlay {
            background: linear-gradient(90deg, rgba(12, 11, 10, 0.98) 0%, rgba(12, 11, 10, 0.85) 45%, rgba(0,0,0,0.4) 100%);
        }

        .scene-content {
            position: relative;
            z-index: 3;
            max-width: 600px;
            opacity: 0;
            transform: translateX(-40px);
            transition: all 1.2s cubic-bezier(0.16, 1, 0.3, 1);
        }
        .scene.active .scene-content { opacity: 1; transform: translateX(0); }

        .story-date {
            font-weight: 800;
            color: var(--primary);
            font-size: 1.1rem;
            text-transform: uppercase;
            letter-spacing: 0.25em;
            margin-bottom: 20px;
            display: block;
        }

        .scene h3 { font-size: clamp(2.5rem, 5vw, 4rem); line-height: 1.1; margin-bottom: 20px; color: var(--text-dark); }
        .scene p { font-size: 1.3rem; color: var(--text-muted); font-weight: 500; line-height: 1.7; }
        
        body.dark-mode .scene p { color: #e5d8d0; text-shadow: 0 1px 2px rgba(0,0,0,0.5); }

        .story-progress-fixed {
            position: absolute;
            left: 5%;
            top: 0;
            bottom: 0;
            width: 2px;
            background: rgba(255, 165, 0, 0.15);
            z-index: 10;
        }

        .story-bar {
            position: sticky;
            top: 50%;
            width: 6px;
            height: 100px;
            background: var(--primary);
            border-radius: 10px;
            transform: translateX(-2px);
            box-shadow: 0 0 20px var(--primary);
        }

        /* --- Map Section Styling --- */
        #where-are-we {
            padding: 160px 5%;
            background: var(--white);
            z-index: var(--z-content);
            transition: background 0.5s ease;
        }
        body.dark-mode #where-are-we { background: var(--cream); }

        #map-container {
            width: 100%;
            height: 600px;
            border-radius: 60px;
            overflow: hidden;
            border: 1px solid var(--glass-border);
            box-shadow: 0 40px 100px rgba(0,0,0,0.05);
            position: relative;
        }

        /* Leaflet Overrides */
        .leaflet-container { font-family: 'Quicksand', sans-serif; background: var(--cream); }
        
        /* Custom Avatar Marker Style */
        .map-avatar-marker {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            border: 3px solid var(--white);
            background: var(--primary);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
            overflow: hidden;
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275), border-color 0.3s ease;
            cursor: pointer;
        }
        .map-avatar-marker:hover {
            transform: scale(1.3) translateY(-8px);
            border-color: var(--primary);
            z-index: 1000 !important;
        }
        .map-avatar-marker img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .map-avatar-fallback {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 800;
            font-size: 1.2rem;
        }

        /* --- Who We Are (Refined Bento Grid) --- */
        #who-we-are { 
            padding: 160px 5%; 
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            z-index: var(--z-content);
        }

        .bento-grid { 
            display: grid; 
            grid-template-columns: repeat(3, 1fr); 
            gap: 32px; 
        }

        .bento-item { 
            border-radius: 45px; 
            padding: 55px; 
            position: relative; 
            overflow: hidden; 
            min-height: 440px; 
            display: flex; 
            flex-direction: column; 
            justify-content: flex-end; 
            border: 1px solid var(--glass-border); 
            background-size: cover; 
            background-position: center; 
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275), box-shadow 0.4s ease; 
        }

        .bento-item::before { 
            content: ''; 
            position: absolute; 
            top: 0; left: 0; right: 0; bottom: 0; 
            background: linear-gradient(to top, rgba(0,0,0,0.85) 0%, rgba(0,0,0,0.2) 60%, transparent 100%); 
            z-index: 1; 
        }

        .bento-item:hover { 
            transform: translateY(-12px) scale(1.01); 
            box-shadow: 0 25px 60px rgba(0,0,0,0.15); 
        }
        
        .bento-content { 
            position: relative; 
            z-index: 2; 
            color: white !important; 
            text-shadow: 0 2px 12px rgba(0,0,0,0.5); 
        }

        .bento-content h3 { font-size: 2.2rem; margin-bottom: 15px; }
        .bento-content p { font-size: 1.15rem; opacity: 0.95; line-height: 1.6; }

        .bento-item:nth-child(1) { grid-column: span 1; background-image: url('https://images.unsplash.com/photo-1529156069898-49953e39b3ac?auto=format&fit=crop&q=80&w=800'); }
        .bento-item:nth-child(2) { grid-column: span 1; background-image: url('https://images.unsplash.com/photo-1573497620053-ea5300f94f21?auto=format&fit=crop&q=80&w=800'); }
        .bento-item:nth-child(3) { grid-column: span 1; background-image: url('https://images.unsplash.com/photo-1543269865-cbf427effbad?auto=format&fit=crop&q=80&w=800'); }
        .bento-item:nth-child(4) { grid-column: span 3; background-image: url('https://images.unsplash.com/photo-1517048676732-d65bc937f952?auto=format&fit=crop&q=80&w=1600'); min-height: 400px; }

        /* --- Membership Card Generator --- */
        #membership {
            padding: 160px 5%;
            background: var(--cream);
            z-index: var(--z-content);
            text-align: center;
        }
        body.dark-mode #membership { background: var(--white); }

        .card-generator-box {
            max-width: 1000px;
            margin: 60px auto 0;
            display: flex;
            flex-wrap: wrap;
            gap: 40px;
            background: var(--glass-bg-dark);
            border: 1px solid var(--glass-border);
            padding: 60px;
            border-radius: 60px;
            box-shadow: 0 40px 100px rgba(0,0,0,0.05);
            align-items: center;
            justify-content: center;
        }

        .card-controls {
            flex: 1;
            min-width: 300px;
            text-align: left;
        }

        .card-controls h3 { font-size: 2rem; margin-bottom: 15px; color: var(--text-dark); }
        .card-controls p { margin-bottom: 30px; color: var(--text-muted); font-weight: 500; }

        .input-group { margin-bottom: 25px; position: relative; }
        .input-group label { display: block; font-weight: 800; font-size: 0.8rem; text-transform: uppercase; color: var(--primary); margin-bottom: 10px; }
        .input-group input {
            width: 100%; padding: 18px 25px; border-radius: 20px; border: 1px solid var(--glass-border);
            background: var(--white); font-family: 'Quicksand', sans-serif; font-size: 1.1rem;
            color: var(--text-dark); transition: border-color 0.3s;
        }
        .input-group input:focus { border-color: var(--primary); outline: none; }

        .card-preview-area {
            flex: 1.2;
            min-width: 350px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #membershipCanvas {
            max-width: 100%;
            height: auto;
            border-radius: 25px;
            box-shadow: 0 30px 60px rgba(0,0,0,0.1);
            background: white;
            border: 1px solid var(--glass-border);
        }

        .card-actions { margin-top: 30px; display: flex; gap: 15px; }

        /* --- Quiz Section --- */
        #quiz-section {
            padding: 160px 5%;
            background: var(--white);
            z-index: var(--z-content);
            text-align: center;
        }
        body.dark-mode #quiz-section { background: var(--cream); }

        .quiz-container {
            max-width: 800px;
            margin: 60px auto 0;
            background: var(--glass-bg-dark);
            border: 1px solid var(--glass-border);
            padding: 60px;
            border-radius: 60px;
            box-shadow: 0 40px 100px rgba(0,0,0,0.05);
            min-height: 450px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .quiz-step {
            display: none;
            animation: fadeIn 0.5s ease-out;
        }
        .quiz-step.active { display: block; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .quiz-question { font-size: 1.8rem; margin-bottom: 40px; font-weight: 700; color: var(--text-dark); }
        
        .quiz-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .quiz-btn {
            background: var(--cream);
            border: 1px solid var(--glass-border);
            padding: 20px 30px;
            border-radius: 30px;
            font-family: 'Quicksand', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            color: var(--text-dark);
            transition: all 0.3s ease;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .quiz-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(255, 165, 0, 0.2);
        }

        .quiz-progress {
            margin-top: 40px;
            height: 6px;
            background: rgba(0,0,0,0.05);
            border-radius: 10px;
            overflow: hidden;
        }
        .quiz-progress-bar {
            height: 100%;
            background: var(--primary);
            width: 0%;
            transition: width 0.4s ease;
        }

        /* --- Hymn Section --- */
        #hymn { padding: 140px 5%; min-height: 100vh; display: flex; flex-direction: column; justify-content: center; z-index: var(--z-content); }
        .hymn-player { 
            display: flex; flex-wrap: wrap; background: var(--glass-bg-dark); 
            border-radius: 60px; overflow: hidden; border: 1px solid var(--glass-border); 
            box-shadow: 0 40px 100px rgba(0,0,0,0.1);
        }
        
        .hymn-lyrics-panel { 
            flex: 1.2; padding: 80px 60px; min-width: 350px; 
            background: linear-gradient(rgba(var(--hero-overlay-rgb), 0.3), rgba(var(--hero-overlay-rgb), 0.5)),
                        url('https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?auto=format&fit=crop&q=40&w=800');
            background-size: cover;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }

        .lyrics-sheet { 
            background: var(--glass-bg); backdrop-filter: blur(25px); 
            padding: 50px; border-radius: 40px; border-left: 8px solid var(--primary); 
            box-shadow: 0 20px 50px rgba(0,0,0,0.05);
            max-width: 100%;
        }
        .lyrics-sheet h3 { font-size: 2rem; margin-bottom: 5px; color: var(--text-dark); }
        .lyrics-meta { font-weight: 700; color: var(--primary-dark); margin-bottom: 30px; display: block; text-transform: uppercase; font-size: 0.85rem; letter-spacing: 0.1em; }
        .lyrics-sheet p { font-size: 1.25rem; line-height: 2; color: var(--text-dark); font-weight: 500; }
        .lyrics-sheet p strong { display: block; margin: 35px 0; color: var(--primary-dark); border-top: 2px solid var(--peach); padding-top: 25px; }

        .hymn-video-panel { flex: 1; min-width: 350px; background: black; display: flex; align-items: center; justify-content: center; position: relative; }
        .hymn-video-panel iframe { width: 100%; height: 100%; min-height: 500px; border: none; }

        /* --- Message Section (Envelope Toggle) --- */
        #message {
            background: linear-gradient(rgba(var(--hero-overlay-rgb), var(--letter-overlay, 0.7)), rgba(var(--hero-overlay-rgb), var(--letter-overlay, 0.7))), 
                        url('https://images.unsplash.com/photo-1497633762265-9d179a990aa6?auto=format&fit=crop&q=80&w=2000');
            background-size: cover; background-attachment: fixed; padding: 180px 5%;
            min-height: 100vh; display: flex; align-items: center; justify-content: center;
            z-index: var(--z-content);
        }
        body.dark-mode #message { --letter-overlay: 0.94; }

        .envelope-trigger {
            background: var(--glass-bg);
            backdrop-filter: blur(30px);
            border: 1px solid var(--glass-border);
            padding: 60px 80px;
            border-radius: 50px;
            text-align: center;
            box-shadow: 0 40px 100px rgba(0,0,0,0.1);
            transition: var(--transition-smooth);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            cursor: pointer;
        }
        .envelope-trigger:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 50px 120px rgba(0,0,0,0.15);
            background: var(--white);
        }
        .envelope-icon {
            font-size: 5rem;
            color: var(--primary);
            margin-bottom: 10px;
        }
        .envelope-trigger h3 { font-size: 2rem; color: var(--text-dark); }

        /* --- Team Grid Section --- */
        #team { padding: 160px 5%; min-height: 100vh; z-index: var(--z-content); }
        .team-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 30px; }
        .team-card { 
            background: var(--glass-bg); backdrop-filter: blur(20px); padding: 50px 30px; 
            border-radius: 40px; text-align: center; border: 1px solid var(--glass-border); 
            transition: var(--transition-smooth);
            cursor: pointer;
        }
        .team-card:hover { border-color: var(--primary); background: var(--glass-bg-dark); transform: translateY(-10px); box-shadow: 0 20px 50px rgba(0,0,0,0.05); }
        
        .avatar-wrapper {
            position: relative;
            width: 80px;
            height: 80px;
            margin: 0 auto 25px;
        }
        .initial-avatar { 
            width: 100%; height: 100%; 
            background: var(--peach); color: var(--coffee); 
            border-radius: 50%; display: flex; 
            align-items: center; justify-content: center; 
            font-weight: 800; font-size: 1.8rem; transition: 0.4s; 
            overflow: hidden; /* For images */
        }
        .initial-avatar img {
            width: 100%; height: 100%; object-fit: cover;
        }
        .flag-badge {
            position: absolute;
            bottom: -5px;
            right: -5px;
            font-size: 1.6rem;
            filter: drop-shadow(0 2px 5px rgba(0,0,0,0.2));
            pointer-events: none;
        }
        .team-card:hover .initial-avatar { background: var(--primary); color: white; transform: rotate(15deg) scale(1.1); }
        .team-card h3 { font-size: 1.4rem; margin-bottom: 10px; }
        .team-card p { font-weight: 700; color: var(--primary-dark); font-size: 0.9rem; text-transform: uppercase; letter-spacing: 0.1em; opacity: 0.9; }

        /* --- Profile & Letter Modals --- */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            z-index: 10001;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.4s ease;
            padding: 20px;
        }

        .modal-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }

        .modal-content {
            background: var(--glass-bg-dark);
            padding: 60px 50px;
            border-radius: 60px;
            max-width: 500px;
            width: 100%;
            position: relative;
            text-align: center;
            border: 1px solid var(--glass-border);
            transform: translateY(40px) scale(0.9);
            transition: transform 0.5s cubic-bezier(0.16, 1, 0.3, 1);
            box-shadow: 0 50px 100px rgba(0,0,0,0.2);
            overflow-y: auto;
            max-height: 90vh;
        }
        
        /* Wider Content for the Letter */
        .letter-modal-content { max-width: 900px; padding: 100px 80px; text-align: justify; }

        .modal-overlay.active .modal-content {
            transform: translateY(0) scale(1);
        }

        .modal-close {
            position: absolute;
            top: 30px; right: 30px;
            background: none; border: none;
            color: var(--text-dark);
            cursor: pointer;
            opacity: 0.5;
            transition: 0.3s;
        }
        .modal-close:hover { opacity: 1; transform: rotate(90deg); }

        .modal-avatar-wrapper {
            position: relative;
            width: 100px; height: 100px; margin: 0 auto 25px;
        }
        .modal-avatar {
            width: 100%; height: 100%; background: var(--primary);
            color: white; border-radius: 50%; display: flex; align-items: center;
            justify-content: center; font-size: 2.5rem; font-weight: 800;
            box-shadow: 0 15px 30px rgba(255,165,0,0.3);
            overflow: hidden;
        }
        .modal-avatar img {
            width: 100%; height: 100%; object-fit: cover;
        }

        .modal-name { font-size: 2.2rem; color: var(--text-dark); margin-bottom: 5px; }
        .modal-desc { color: var(--primary); font-weight: 700; text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 20px; font-size: 0.9rem; }
        
        .modal-summary { 
            font-size: 1.1rem; 
            line-height: 1.6; 
            color: var(--text-muted); 
            margin-bottom: 30px; 
            text-align: center;
            padding: 0 10px;
        }
        
        /* Letter Text Specifics */
        .letter-body p { font-size: 1.25rem; margin-bottom: 25px; font-weight: 500; color: var(--text-dark); line-height: 1.8; }
        .signature { text-align: right; font-size: 2.8rem; color: var(--primary); font-weight: 800; margin-top: 50px; font-family: 'Lexend', sans-serif; }

        .modal-divider { width: 60px; height: 3px; background: var(--peach); margin: 0 auto 30px; border-radius: 2px; }

        .modal-info-group { text-align: left; background: rgba(0,0,0,0.03); padding: 25px; border-radius: 30px; margin-top: 10px; }
        body.dark-mode .modal-info-group { background: rgba(255,255,255,0.03); }

        .info-item { display: flex; align-items: center; gap: 15px; margin-bottom: 15px; }
        .info-item:last-child { margin-bottom: 0; }
        .info-label { font-weight: 800; font-size: 0.8rem; text-transform: uppercase; letter-spacing: 0.05em; color: var(--coffee-light); min-width: 100px; }
        .info-value { font-weight: 600; color: var(--text-dark); }

        /* --- Footer --- */
        footer {
            background-color: var(--coffee);
            color: var(--footer-text);
            padding: 140px 5% 60px;
            text-align: center;
            border-radius: 100px 100px 0 0;
            background-image: linear-gradient(var(--footer-overlay), var(--footer-overlay-deep)), 
                              url('https://images.unsplash.com/photo-1447933601403-0c6688de566e?auto=format&fit=crop&q=80&w=1200');
            background-size: cover;
            position: relative;
            z-index: var(--z-content);
            margin-top: -60px;
            min-height: 80vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .footer-logo { font-size: clamp(3rem, 8vw, 5rem); margin-bottom: 20px; display: inline-block; text-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .footer-tagline { font-size: 1.4rem; opacity: 0.9; max-width: 700px; margin: 0 auto 60px; font-weight: 500; }
        
        .social-icons { display: flex; justify-content: center; gap: 30px; margin-bottom: 60px; }
        .social-link {
            width: 70px; height: 70px; background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 50%;
            display: flex; align-items: center; justify-content: center; color: white;
            transition: var(--transition-smooth); text-decoration: none;
        }
        .social-link:hover { background: var(--primary); border-color: var(--primary); transform: translateY(-5px); color: white; }

        .copyright-text { opacity: 0.7; font-size: 0.9rem; letter-spacing: 0.15em; text-transform: uppercase; font-weight: 700; color: var(--footer-text); }

        /* --- Mobile Responsiveness --- */
        @media (max-width: 1024px) {
            .bento-grid { grid-template-columns: repeat(2, 1fr); gap: 20px; }
            .bento-item:nth-child(3) { grid-column: span 2; min-height: 350px; }
            .bento-item:nth-child(4) { grid-column: span 2; min-height: 350px; }
        }

        @media (max-width: 768px) {
            #cursor { display: none; } * { cursor: auto !important; }
            nav { padding: 15px 0; }
            .nav-links { position: fixed; top: 0; right: -100%; width: 85%; height: 100vh; background: var(--nav-bg); backdrop-filter: blur(25px); flex-direction: column; justify-content: center; align-items: center; transition: 0.6s cubic-bezier(0.16, 1, 0.3, 1); box-shadow: -20px 0 60px rgba(0,0,0,0.15); }
            .nav-links.active { right: 0; }
            .mobile-toggle { display: block; }
            .hero-title { font-size: 3.5rem; }
            .scene { padding: 0 8% 0 15%; }
            .scene h3 { font-size: 2.2rem; }
            .scene p { font-size: 1.15rem; }
            #who-we-are { padding: 100px 5%; }
            #where-are-we { padding: 100px 5%; }
            #map-container { height: 400px; border-radius: 40px; }
            .bento-grid { grid-template-columns: 1fr; gap: 16px; }
            .bento-item { grid-column: span 1 !important; min-height: 320px !important; padding: 35px; }
            .bento-content h3 { font-size: 1.8rem; }
            .hymn-lyrics-panel { padding: 50px 25px; } 
            .lyrics-sheet { padding: 30px 20px; }
            .quiz-options { grid-template-columns: 1fr; }
            .quiz-container { padding: 40px 25px; }
            .card-generator-box { padding: 40px 25px; border-radius: 40px; }
            .card-controls { min-width: 100%; text-align: center; }
            .card-preview-area { min-width: 100%; }
            .team-grid { grid-template-columns: 1fr 1fr; gap: 15px; }
            .team-card { padding: 40px 20px; }
            .avatar-wrapper { width: 60px; height: 60px; }
            .initial-avatar { font-size: 1.4rem; }
            #team, #hymn, #message, #membership { padding: 100px 5%; min-height: auto; }
            .envelope-trigger { padding: 40px 30px; width: 100%; }
            .letter-modal-content { padding: 60px 25px; }
            .letter-body p { font-size: 1.1rem; }
            footer { padding: 100px 5% 50px; min-height: auto; }
            .social-link { width: 55px; height: 55px; }
            .modal-content { padding: 50px 30px; }
            .modal-name { font-size: 1.8rem; }
        }

        @media (max-width: 480px) { 
            .team-grid { grid-template-columns: 1fr; } 
            .hero-title { font-size: 2.8rem; }
        }

        /* --- Utilities --- */
        .rain-item { position: fixed; top: -50px; pointer-events: none; z-index: 1001; font-size: 24px; animation: fall 5s linear forwards; }
        @keyframes fall { to { transform: translateY(110vh) rotate(360deg); } }
    </style>
</head>
<body class="light-mode">

    <div id="cursor">ü•ê</div>
    <div id="bg-assets-container"></div>

    <nav>
        <div class="nav-container">
            <a href="#" class="logo-box magnetic" id="logo">
                <span class="brand-name">NEACT</span>
            </a>
            <ul class="nav-links" id="navLinks">
                <li><a href="#history" class="magnetic">Our Journey</a></li>
                <li><a href="#where-are-we" class="magnetic">Global Reach</a></li>
                <li><a href="#who-we-are" class="magnetic">Who We Are</a></li>
                <li><a href="#membership" class="magnetic">Member ID</a></li>
                <li><a href="#quiz-section" class="magnetic">The Table Test</a></li>
                <li><a href="#hymn" class="magnetic">Hymn</a></li>
                <li><a href="#team" class="magnetic">The 19</a></li>
                <li>
                    <button class="theme-toggle magnetic" id="themeToggle" title="Switch Theme">
                        <i data-lucide="sun"></i>
                    </button>
                </li>
            </ul>
            <div class="mobile-toggle" id="menuToggle">
                <i data-lucide="menu" size="32"></i>
            </div>
        </div>
    </nav>

    <section id="hero">
        <div class="hero-badge reveal">Est. August 2021</div>
        <h1 class="hero-title reveal">NEVER ENDING AND <span>CROISSANT TABLE</span></h1>
        <p class="hero-sub reveal">We are a community of friendly people who like deep conversations and be close to one another.</p>
        <a href="#history" class="btn-main reveal magnetic">
            Start the Journey <i data-lucide="play"></i>
        </a>
    </section>

    <!-- CINEMATIC TIMELINE -->
    <section id="history">
        <div class="history-intro">
            <div class="section-header reveal">
                <h2 class="section-title">Our Journey</h2>
                <p class="section-sub">Tracing the legacy from Hilokal to the Cafe.</p>
            </div>
        </div>

        <div class="story-container">
            <div class="story-progress-fixed">
                <div class="story-bar" id="storyBar"></div>
            </div>

            <div class="scene" id="era-roots">
                <div class="scene-bg" style="background-image: url('https://images.unsplash.com/photo-1550684376-efcbd6e3f031?auto=format&fit=crop&q=80&w=1600');"></div>
                <div class="scene-overlay"></div>
                <div class="scene-content">
                    <span class="story-date">The Roots</span>
                    <h3>The Hilokal Era</h3>
                    <p>Formed on <strong>Hilokal</strong>, a language-learning app where group "tables" became social hubs. Here, communities were established, laying the groundwork for what was to come.</p>
                </div>
            </div>

            <div class="scene" id="era-aug2021">
                <div class="scene-bg" style="background-image: url('https://images.unsplash.com/photo-1550684848-fac1c5b4e853?auto=format&fit=crop&q=80&w=1600');"></div>
                <div class="scene-overlay"></div>
                <div class="scene-content">
                    <span class="story-date">August 2021</span>
                    <h3>Croissant Gang Born</h3>
                    <p>A group of friends trying to pronounce "Croissant" created a legacy! Famous for the <strong>BTS Broke Concert</strong> on Aug 12, 2021, performing with full guests and meet & greets.</p>
                </div>
            </div>

            <div class="scene" id="era-oct2021">
                <div class="scene-bg" style="background-image: url('https://images.unsplash.com/photo-1504333638930-c8787321eee0?auto=format&fit=crop&q=80&w=1600');"></div>
                <div class="scene-overlay"></div>
                <div class="scene-content">
                    <span class="story-date">October 2021</span>
                    <h3>A Never Ending Legacy</h3>
                    <p>The <strong>Happily Never Ending Table</strong> became the top Tagalog hub on Hilokal. Known for never closing its doors, it was a constant home for Filipinos everywhere.</p>
                </div>
            </div>

            <div class="scene" id="era-halloween">
                <div class="scene-bg" style="background-image: url('https://images.unsplash.com/photo-1558591710-4b4a1ae0f04d?auto=format&fit=crop&q=80&w=1600');"></div>
                <div class="scene-overlay"></div>
                <div class="scene-content">
                    <span class="story-date">Oct 31, 2021</span>
                    <h3>The Halloween Fusion</h3>
                    <p>At the stroke of midnight during a Halloween party, the Croissant Gang and Never Ending members merged. <strong>NEACT</strong> was officially born from this magical synergy.</p>
                </div>
            </div>

            <div class="scene" id="era-cafe">
                <div class="scene-bg" style="background-image: url('https://images.unsplash.com/photo-1514432324607-a09d9b4aefdd?auto=format&fit=crop&q=80&w=1600');"></div>
                <div class="scene-overlay"></div>
                <div class="scene-content">
                    <span class="story-date">Nov 12, 2021</span>
                    <h3>Never Ending Cafe</h3>
                    <p>Due to rising popularity, we opened the <strong>Never Ending Cafe</strong>. Since then, NEACT has expanded as a solid community, broadening horizons across global boundaries.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- WHERE ARE WE MAP SECTION -->
    <section id="where-are-we">
        <div class="section-header reveal">
            <h2 class="section-title">Where Are We?</h2>
            <p class="section-sub">A global family across oceans and borders. Click an avatar to say hi!</p>
        </div>
        <div id="map-container" class="reveal">
            <div id="map" style="width: 100%; height: 100%;"></div>
        </div>
    </section>

    <section id="who-we-are">
        <div class="section-header reveal">
            <h2 class="section-title">Who We Are</h2>
        </div>

        <div class="bento-grid">
            <div class="bento-item reveal">
                <div class="bento-content">
                    <h3>Friendship</h3>
                    <p>Everyone is welcome at our table. We build genuine bonds that last a lifetime.</p>
                </div>
            </div>
            <div class="bento-item reveal">
                <div class="bento-content">
                    <h3>Issuer (Support)</h3>
                    <p>Helping members navigate through life's challenges with collective strength.</p>
                </div>
            </div>
            <div class="bento-item reveal">
                <div class="bento-content">
                    <h3>Cheka</h3>
                    <p>A safe space to share your story. Privacy is respected, and every voice is heard.</p>
                </div>
            </div>
            <div class="get-item bento-item reveal">
                <div class="bento-content">
                    <h3>Our Goal</h3>
                    <p>‚ÄúFostering genuine connections, building bridges of understanding, and creating a global community where friendship transcends boundaries ‚Äî inspiring kindness, support, and camaraderie.‚Äù</p>
                </div>
            </div>
        </div>
    </section>

    <!-- MEMBERSHIP CARD SECTION -->
    <section id="membership">
        <div class="section-header reveal">
            <h2 class="section-title">Get Your Member ID</h2>
            <p class="section-sub">You're officially one of us. Personalize your NEACT digital ID card below.</p>
        </div>

        <div class="card-generator-box reveal">
            <div class="card-controls">
                <h3>Identity Builder</h3>
                <p>Enter your nickname to personalize your official Never Ending and Croissant Table membership card.</p>
                
                <div class="input-group">
                    <label for="memberNameInput">Member Nickname</label>
                    <input type="text" id="memberNameInput" placeholder="e.g. BreadLover_99" maxlength="18">
                </div>

                <div class="card-actions">
                    <button class="btn-main magnetic" id="downloadCardBtn">
                        <i data-lucide="download"></i> Download ID
                    </button>
                    <button class="quiz-btn magnetic" style="padding: 18px 25px;" id="refreshCardBtn">
                        <i data-lucide="refresh-cw"></i> Randomize ID
                    </button>
                </div>
            </div>

            <div class="card-preview-area">
                <canvas id="membershipCanvas" width="600" height="350"></canvas>
            </div>
        </div>
    </section>

    <!-- QUIZ SECTION -->
    <section id="quiz-section">
        <div class="section-header reveal">
            <h2 class="section-title">The Table Test</h2>
            <p class="section-sub">Which NEACT member are you actually? Take the quiz to find your vibe.</p>
        </div>
        
        <div class="quiz-container reveal">
            <!-- Start Screen -->
            <div class="quiz-step active" id="quiz-start">
                <div class="quiz-question">Ready to find your NEACT counterpart?</div>
                <button class="btn-main magnetic" onclick="startQuiz()">
                    Start the Quiz <i data-lucide="chevron-right"></i>
                </button>
            </div>

            <!-- Question Template (Dynamic) -->
            <div class="quiz-step" id="quiz-q">
                <div class="quiz-question" id="q-text">Question goes here?</div>
                <div class="quiz-options" id="q-options">
                    <!-- Buttons will be injected here -->
                </div>
            </div>

            <!-- Loading/Result Trigger -->
            <div class="quiz-step" id="quiz-loading">
                <div class="quiz-question">Consulting the Croissant Table...</div>
                <div class="social-icons" style="justify-content: center;">
                    <i data-lucide="coffee" class="spin" style="animation: logo-spin 1.5s infinite linear;"></i>
                </div>
            </div>

            <div class="quiz-progress">
                <div class="quiz-progress-bar" id="quiz-progress-bar"></div>
            </div>
        </div>
    </section>

    <section id="hymn">
        <div class="section-header reveal">
            <h2 class="section-title">The NEACT Hymn</h2>
        </div>
        <div class="hymn-player reveal">
            <div class="hymn-lyrics-panel">
                <div class="lyrics-sheet">
                    <h3>Ang Awit ng NEACT</h3>
                    <span class="lyrics-meta">Musika at Titik ni Harry Potato</span>
                    <p>
                        Doon sa dulong silangan ay mayroong mesa tahanang pagkakaibigan 'Di ka magiisa
                        <br>
                        <strong>
                            'Never Ending' - mahal na table 
                            <br>Kailan man hinding-hindi matatapos 
                            <br>'Never Ending' - mahal na table 
                            <br>Nagagalak kami sayong lubos
                        </strong>
                        <br>
                        Mula sa Croissant at Mananap Sila'y nagsama-sama Sa ginahawa at sa hirap Tiyak kapiling ka
                    </p>
                </div>
            </div>
            <div class="hymn-video-panel">
                <iframe src="https://www.youtube.com/embed/WPtQN58Irkc" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
            </div>
        </div>
    </section>

    <!-- Trigger Section for the Letter -->
    <section id="message">
        <div class="envelope-trigger reveal magnetic" id="openLetter">
            <div class="envelope-icon">
                <i data-lucide="mail" size="80"></i>
            </div>
            <h3>A Personal Note</h3>
        </div>
    </section>

    <section id="team">
        <div class="section-header reveal">
            <h2 class="section-title">Meet The NEACT 19</h2>
            <p style="font-weight: 700; color: var(--coffee-light); margin-top: 15px; font-size: 0.95rem; text-transform: uppercase; letter-spacing: 0.12em;">The heartbeat of our Never Ending family.</p>
        </div>
        <div class="team-grid" id="teamGrid"></div>
    </section>

    <footer>
        <div class="footer-logo brand-name reveal">NEACT</div>
        <p class="footer-tagline reveal">Friendship without limits. A global legacy of kindness, support, and the Never Ending and Croissant Table.</p>
        <div class="social-icons reveal">
            <a href="#" class="social-link magnetic" title="Instagram">
                <i data-lucide="instagram" size="24"></i>
            </a>
            <a href="#" class="social-link magnetic" title="Twitter">
                <i data-lucide="twitter" size="24"></i>
            </a>
            <a href="#" class="social-link magnetic" title="Email">
                <i data-lucide="mail" size="24"></i>
            </a>
        </div>
        <p class="copyright-text">&copy; <span id="year"></span> NEACT LEGACY. DESIGNED FOR MEMORIES.</p>
    </footer>

    <!-- PROFILE MODAL -->
    <div id="profileModal" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close" id="closeProfileModal">
                <i data-lucide="x" size="32"></i>
            </button>
            <div class="modal-avatar-wrapper">
                <div class="modal-avatar" id="modalAvatar">?</div>
                <div class="flag-badge" id="modalFlagBadge"></div>
            </div>
            <h3 class="modal-name" id="modalName">Name</h3>
            <p class="modal-desc" id="modalDesc">Original Description</p>
            <div class="modal-summary" id="modalSummary">Summary of the person appears here.</div>
            <div class="modal-divider"></div>
            <div class="modal-info-group">
                <div class="info-item">
                    <span class="info-label">Nationality</span>
                    <span class="info-value" id="modalFlags">üáØüá¥</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Languages</span>
                    <span class="info-value" id="modalLang">Arabic, English</span>
                </div>
            </div>
        </div>
    </div>

    <!-- LETTER MODAL -->
    <div id="letterModal" class="modal-overlay">
        <div class="modal-content letter-modal-content">
            <button class="modal-close" id="closeLetterModal">
                <i data-lucide="x" size="32"></i>
            </button>
            <div class="letter-body">
                <p>Lately, I‚Äôve been thinking about our time on Hilokal more than I expected to. And if you‚Äôre reading this, maybe it‚Äôs because you‚Äôve felt that same way too.</p>
                <p>We‚Äôve all gone back to our ‚Äúreal‚Äù lives now. The tables are mostly empty, the app doesn‚Äôt feel the same, and the familiar notifications no longer light up our screens. But I couldn‚Äôt let all that silence pass without saying thank you.</p>
                <p>When the pandemic hit and the world suddenly felt small and lonely, those tables became my entire world. We joined to practice languages, but somehow we ended up practicing how to survive a really hard chapter together. Those long nights, sometimes studying, but mostly just talking, laughing, venting, and keeping each other company when there was nowhere else to be meant more to me than I can properly explain. They kept me going.</p>
                <p>It still amazes me how people I never met in person became such a big part of my everyday life. You weren‚Äôt just voices or avatars on a screen. You were my routine, my comfort, my sense of belonging when everything else felt uncertain. That connection was real, and it mattered.</p>
                <p>I‚Äôm genuinely happy to see everyone moving forward now, building their lives, chasing the things we used to talk about while the world was paused. That‚Äôs what we were waiting for back then, after all, for life to start again. Still, a part of me misses those nights and the people who made them special. I‚Äôll always carry the memory of those voices that made the lockdowns feel less heavy.</p>
                <p>Even if we never find ourselves at the same table again, I‚Äôm deeply grateful for the time we shared. I hope you‚Äôre doing well, wherever you are. I‚Äôm quietly cheering for you.</p>
                <div class="signature">Harry</div>
            </div>
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script>
        lucide.createIcons();
        document.getElementById('year').textContent = new Date().getFullYear();

        const team = [
            { id: "jade", name: "Jade", desc: "The Heart of Jordan", summary: "Jade has been a pillar of the community since the Hilokal days, bringing a warm Jordanian spirit and helping bridge cultural gaps with kindness and genuine curiosity.", flags: "üáµüá≠ üáØüá¥", lang: "Arabic, Tagalog, Cebuano, English", avatar: "jade-avatar.jpg", lat: 31.9454, lng: 35.9284, traits: ['bridging', 'warm', 'kind'] }, 
            { id: "rosette", name: "Rosette", desc: "Classy & Compassionate", summary: "Known for her sophisticated charm and deep empathy, Rosette provides a listening ear to everyone at the table, making sure no one feels left out during deep 'cheka' sessions.", flags: "üáµüá≠", lang: "Tagalog, Kapampangan, English", avatar: "rosette-avatar.jpg", lat: 15.0286, lng: 120.6898, traits: ['empathy', 'classy', 'listening'] },
            { id: "sophie", name: "Maple/Sophie", desc: "The Sweetest Bunso", summary: "As our beloved youngest member, Sophie brings energy and a fresh perspective to every conversation, reminding us all of the joy of discovery and new beginnings.", flags: "üáµüá≠", lang: "Tagalog, English", avatar: "maple-avatar.jpg", lat: 14.5995, lng: 120.9842, traits: ['young', 'energy', 'fresh'] }, 
            { id: "ginnie", name: "Ginnie", desc: "Our Timeless Wisdom", summary: "Ginnie holds the stories of NEACT close to her heart. Her wisdom and 'ageless' spirit guide the group through challenges with grace and calm authority.", flags: "üáµüá≠", lang: "Tagalog, Pangasinense, English", avatar: "ginnie-avatar.jpg", lat: 16.0355, lng: 120.3311, traits: ['wisdom', 'guiding', 'calm'] },
            { id: "harry", name: "Harry", desc: "The Manila Boy", summary: "The creative force behind our hymn, Harry's Manila roots and musical talent gave NEACT its voice. He believes that every friendship deserves a melody.", flags: "üáµüá≠", lang: "Tagalog, English", avatar: "harry-avatar.jpg", lat: 14.5800, lng: 121.0300, traits: ['creative', 'musical', 'voice'] }, 
            { id: "ca", name: "C.A.", desc: "The Future Dreamer", summary: "A passionate soul with big dreams and a bigger heart for K-Pop. C.A. adds a layer of fun and shared interests that keeps our chats vibrant and current.", flags: "üáµüá≠", lang: "Tagalog, Iloko, English", avatar: "ca-avatar.jpg", lat: 17.5700, lng: 120.3800, traits: ['dreamer', 'passionate', 'fun'] },
            { id: "ashley", name: "Ashley", desc: "Multi-cultural Soul", summary: "Living between two worlds, Ashley embodies the global spirit of NEACT, effortlessly blending Korean and Filipino cultures into a unique, lovable personality.", flags: "üá∞üá∑ üáµüá≠", lang: "Korean, Tagalog, English", avatar: "ashley-avatar.jpg", lat: 37.5665, lng: 126.9780, traits: ['global', 'blending', 'lovable'] }, 
            { id: "joshua", name: "Joshua", desc: "Always Reliable Friend", summary: "If you need a hand or a midnight chat, Joshua is the 'one call away' friend. His reliability is a cornerstone of the trust we share in the Cafe.", flags: "üáµüá≠", lang: "Tagalog, English", avatar: "joshua-avatar.jpg", lat: 14.4081, lng: 121.0415, traits: ['reliable', 'trust', 'supportive'] },
            { id: "shen", name: "Shen", desc: "Grounding Presence", summary: "Shen's stability is what keeps the table level. In moments of chaos or high energy, her calm demeanor helps everyone find their center.", flags: "üáµüá≠", lang: "Tagalog, Kapampangan, English", avatar: "shen-avatar.jpg", lat: 15.0800, lng: 120.5900, traits: ['stability', 'center', 'grounding'] }, 
            { id: "dado", name: "Dado", desc: "Smooth Navigator", summary: "A mariner with a love for the open sea. Dado brings a sense of adventure and steady navigation to our community's journey.", flags: "üáµüá≠", lang: "Tagalog, Iloko, English", avatar: "dado-avatar.jpg", lat: 12.8797, lng: 121.7740, traits: ['adventure', 'steady', 'navigator'] },
            { id: "melody", name: "Melody", desc: "Academic Excellence", summary: "Melody balances her dedication to her studies with her commitment to our community, inspiring us all to pursue our goals while staying connected.", flags: "üáÆüá≥", lang: "Tamil, English", avatar: "melody-avatar.jpg", lat: 13.0827, lng: 80.2707, traits: ['academic', 'excellence', 'goals'] }, 
            { id: "wintah", name: "Wintah", desc: "Dawn of the North", summary: "Wintah's presence is like a fresh morning. Her kindness and positive outlook make every day in the Never Ending Cafe feel like a new beginning.", flags: "üáµüá≠", lang: "Tagalog, English", avatar: "wintah-avatar.jpg", lat: 18.2164, lng: 120.5930, traits: ['fresh', 'positive', 'dawn'] },
            { id: "juan", name: "Juan", desc: "Effortless Multitasker", summary: "Juan is the master of doing it all. Whether it's managing real-life duties or keeping the table chat going, he does it with a smile and zero stress.", flags: "üáµüá≠", lang: "Tagalog, English", avatar: "juan-avatar.jpg", lat: 14.6760, lng: 121.0437, traits: ['multitasker', 'zero-stress', 'smiles'] }, 
            { id: "joy", name: "Joy", desc: "Strategic Thinker", summary: "Joy's sharp mind and expert 'Plato' skills are matched only by her loyalty. She looks at the big picture and keeps the group moving forward.", flags: "üá≤üáæ", lang: "Tagalog, Malay, Mandarin, English", avatar: "joy-avatar.jpg", lat: 3.1390, lng: 101.6869, traits: ['strategic', 'sharp', 'loyalty'] },
            { id: "guzman", name: "Guzman", desc: "Fashionably Late", summary: "Guzman might not always be the first to arrive, but his entrance is always worth the wait. He brings style and a great sense of humor to the table.", flags: "üáµüá≠", lang: "Tagalog, Cebuano, English", avatar: "guzman-avatar.jpg", lat: 10.3157, lng: 123.8854, traits: ['humor', 'style', 'relaxed'] }, 
            { id: "master", name: "Master", desc: "Coffee Connoisseur", summary: "The ultimate host of the Cafe. Master's love for coffee and deep conversation makes her the perfect guide for new members joining our family.", flags: "üáµüá≠", lang: "Tagalog, Cebuano, English", avatar: "master-avatar.jpg", lat: 7.1907, lng: 125.4553, traits: ['host', 'guide', 'coffee'] },
            { id: "win", name: "Win", desc: "Vibrant Melodies", summary: "Win's passion for music and life is contagious. She keeps our spirits high and ensures there's always a reason to celebrate our friendship.", flags: "üáµüá≠", lang: "Tagalog, English", avatar: "win-avatar.jpg", lat: 13.1391, lng: 123.7438, traits: ['vibrant', 'celebrate', 'contagious'] }, 
            { id: "jael", name: "Ja el", desc: "The Etherial Dreamer", summary: "Ja el has a way of seeing the world differently. Her poetic and 'floating' spirit adds a touch of magic and wonder to our late-night discussions.", flags: "üáµüá≠ üá≤üáæ", lang: "Tagalog, English", avatar: "jael-avatar.jpg", lat: 1.5533, lng: 103.6356, traits: ['poetic', 'magic', 'dreamer'] },
            { id: "yvaine", name: "Yvaine", desc: "Courageous Spirit", summary: "Brave and bold, Yvaine isn't afraid to speak her truth. Her strength inspires others to be authentic and stand tall in the face of adversity.", flags: "üáµüá≠", lang: "Tagalog, English", avatar: "yvaine-avatar.jpg", lat: 14.5547, lng: 121.0244, traits: ['courage', 'bold', 'authentic'] }
        ];

        // Membership Card Logic
        const cardCanvas = document.getElementById('membershipCanvas');
        const ctx = cardCanvas.getContext('2d');
        const nameInput = document.getElementById('memberNameInput');
        const downloadBtn = document.getElementById('downloadCardBtn');
        const refreshBtn = document.getElementById('refreshCardBtn');
        let currentMemberID = Math.floor(1000 + Math.random() * 9000);

        function drawCard() {
            const name = nameInput.value || "NEACT Member";
            const dateStr = "Est. August 2021";
            
            // Background
            const gradient = ctx.createLinearGradient(0, 0, 600, 350);
            gradient.addColorStop(0, '#FFA500'); // Primary
            gradient.addColorStop(1, '#FFB732'); // Primary Light
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, 600, 350);

            // Pattern / Accents
            ctx.fillStyle = 'rgba(255, 255, 255, 0.15)';
            ctx.beginPath();
            ctx.arc(600, 0, 200, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.arc(0, 350, 150, 0, Math.PI * 2);
            ctx.fill();

            // Glass Panel
            ctx.fillStyle = 'rgba(255, 253, 245, 0.2)';
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.5)';
            ctx.lineWidth = 2;
            ctx.roundRect(30, 30, 540, 290, 30);
            ctx.fill();
            ctx.stroke();

            // Logo
            ctx.fillStyle = '#FFFFFF';
            ctx.font = 'bold 36px Lexend, sans-serif';
            ctx.fillText('NEACT', 60, 85);
            
            // Tagline
            ctx.font = '600 12px Lexend, sans-serif';
            ctx.fillText('NEVER ENDING & CROISSANT TABLE', 60, 105);

            // Member Badge
            ctx.fillStyle = '#6F4E37'; // Coffee
            ctx.roundRect(410, 60, 130, 30, 15);
            ctx.fill();
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '800 12px Quicksand, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('OFFICIAL MEMBER', 475, 80);
            ctx.textAlign = 'left';

            // Member Name
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '800 48px Lexend, sans-serif';
            ctx.fillText(name.toUpperCase(), 60, 230);

            // ID Details
            ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
            ctx.font = 'bold 12px Quicksand, sans-serif';
            ctx.fillText('MEMBER ID:', 60, 270);
            ctx.fillText('LEGACY SINCE:', 200, 270);
            
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '800 16px Quicksand, sans-serif';
            ctx.fillText(`#${currentMemberID}`, 60, 290);
            ctx.fillText('AUG 2021', 200, 290);

            // Croissant Emoji
            ctx.font = '60px Arial';
            ctx.fillText('ü•ê', 470, 290);
            
            // QR Placeholder
            ctx.strokeStyle = '#FFFFFF';
            ctx.lineWidth = 1;
            ctx.strokeRect(510, 120, 30, 30);
            ctx.beginPath();
            ctx.moveTo(510, 120); ctx.lineTo(540, 150);
            ctx.moveTo(540, 120); ctx.lineTo(510, 150);
            ctx.stroke();
        }

        nameInput.addEventListener('input', drawCard);
        refreshBtn.addEventListener('click', () => {
            currentMemberID = Math.floor(1000 + Math.random() * 9000);
            drawCard();
        });

        downloadBtn.addEventListener('click', () => {
            const link = document.createElement('a');
            link.download = `NEACT_Member_${nameInput.value || 'ID'}.png`;
            link.href = cardCanvas.toDataURL();
            link.click();
        });

        // Quiz Logic
        const quizData = [
            {
                question: "What's your ideal role at a never-ending table?",
                options: [
                    { text: "The host who makes everyone feel at home", traits: ['host', 'bridging', 'guide'] },
                    { text: "The listener who gives deep advice", traits: ['wisdom', 'empathy', 'listening'] },
                    { text: "The one keeping the vibes high and loud", traits: ['energy', 'fun', 'vibrant'] },
                    { text: "The steady presence in the background", traits: ['stability', 'center', 'grounding'] }
                ]
            },
            {
                question: "Pick your favorite late-night snack vibe.",
                options: [
                    { text: "A fresh croissant and warm coffee", traits: ['coffee', 'fresh', 'classy'] },
                    { text: "Street food and a good laugh", traits: ['humor', 'smiles', 'relaxed'] },
                    { text: "Something new and international", traits: ['global', 'blending', 'adventure'] },
                    { text: "Whatever is nearby, I'm multitasking anyway", traits: ['multitasker', 'zero-stress', 'steady'] }
                ]
            },
            {
                question: "If you were to create something for the group...",
                options: [
                    { text: "A song or a melody", traits: ['creative', 'musical', 'voice'] },
                    { text: "A strategic plan for the future", traits: ['strategic', 'sharp', 'excellence'] },
                    { text: "A safe space for others to vent", traits: ['supportive', 'reliable', 'trust'] },
                    { text: "A poetic piece about our bond", traits: ['poetic', 'magic', 'dreamer'] }
                ]
            },
            {
                question: "How do you handle a chaotic situation?",
                options: [
                    { text: "I stay calm and speak my truth", traits: ['courage', 'authentic', 'bold'] },
                    { text: "I try to guide everyone toward a solution", traits: ['wisdom', 'guiding', 'center'] },
                    { text: "I lighten the mood with a joke", traits: ['humor', 'fun', 'relaxed'] },
                    { text: "I reliably show up for those who need me", traits: ['reliable', 'supportive', 'warm'] }
                ]
            }
        ];

        let currentQ = 0;
        let userPoints = {};

        function startQuiz() {
            document.getElementById('quiz-start').classList.remove('active');
            showQuestion();
        }

        function showQuestion() {
            const q = quizData[currentQ];
            const qContainer = document.getElementById('quiz-q');
            const qText = document.getElementById('q-text');
            const qOptions = document.getElementById('q-options');
            const progressBar = document.getElementById('quiz-progress-bar');

            qText.textContent = q.question;
            qOptions.innerHTML = '';
            
            q.options.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'quiz-btn magnetic';
                btn.innerHTML = `<i data-lucide="circle" size="18"></i> ${opt.text}`;
                btn.onclick = () => handleAnswer(opt.traits);
                qOptions.appendChild(btn);
            });

            lucide.createIcons();
            qContainer.classList.add('active');
            progressBar.style.width = `${(currentQ / quizData.length) * 100}%`;
        }

        function handleAnswer(traits) {
            traits.forEach(t => {
                userPoints[t] = (userPoints[t] || 0) + 1;
            });

            currentQ++;
            document.getElementById('quiz-q').classList.remove('active');

            if (currentQ < quizData.length) {
                setTimeout(showQuestion, 300);
            } else {
                showLoading();
            }
        }

        function showLoading() {
            document.getElementById('quiz-progress-bar').style.width = '100%';
            const loader = document.getElementById('quiz-loading');
            loader.classList.add('active');
            
            setTimeout(() => {
                loader.classList.remove('active');
                calculateResult();
            }, 1500);
        }

        function calculateResult() {
            let bestMatch = team[0];
            let maxScore = -1;

            team.forEach(member => {
                let score = 0;
                member.traits.forEach(trait => {
                    if (userPoints[trait]) score += userPoints[trait];
                });
                if (score > maxScore) {
                    maxScore = score;
                    bestMatch = member;
                }
            });

            openProfileModal(bestMatch);
            const modalNameEl = document.getElementById('modalName');
            modalNameEl.innerHTML = `<span style="display:block; font-size: 0.9rem; color: var(--primary); letter-spacing: 2px;">YOUR MATCH IS:</span> ${bestMatch.name}`;
            
            currentQ = 0;
            userPoints = {};
            document.getElementById('quiz-start').classList.add('active');
            document.getElementById('quiz-progress-bar').style.width = '0%';
        }

        const profileModal = document.getElementById('profileModal');
        const modalAvatar = document.getElementById('modalAvatar');
        const modalFlagBadge = document.getElementById('modalFlagBadge');
        const modalName = document.getElementById('modalName');
        const modalDesc = document.getElementById('modalDesc');
        const modalSummary = document.getElementById('modalSummary');
        const modalFlags = document.getElementById('modalFlags');
        const modalLang = document.getElementById('modalLang');

        function renderAvatarContent(name, avatarUrl) {
            const firstLetter = name.charAt(0);
            if (avatarUrl && avatarUrl.trim() !== "") {
                return `<img src="${avatarUrl}" alt="${name}" onerror="this.parentElement.innerHTML='${firstLetter}'">`;
            }
            return firstLetter;
        }

        function openProfileModal(m) {
            modalAvatar.innerHTML = renderAvatarContent(m.name, m.avatar);
            modalFlagBadge.textContent = m.flags;
            modalName.textContent = m.name;
            modalDesc.textContent = m.desc;
            modalSummary.textContent = m.summary;
            modalFlags.textContent = m.flags;
            modalLang.textContent = m.lang;
            profileModal.classList.add('active');
        }

        function initMap() {
            const map = L.map('map', {
                scrollWheelZoom: false,
                attributionControl: false
            }).setView([15, 80], 3);

            L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
                maxZoom: 19
            }).addTo(map);

            const markers = [];

            team.forEach(m => {
                const iconContent = m.avatar 
                    ? `<img src="${m.avatar}" onerror="this.parentElement.innerHTML='<div class=map-avatar-fallback>${m.name[0]}</div>'">`
                    : `<div class="map-avatar-fallback">${m.name[0]}</div>`;
                
                const customIcon = L.divIcon({
                    className: 'map-avatar-marker',
                    html: iconContent,
                    iconSize: [44, 44],
                    iconAnchor: [22, 44] 
                });

                const marker = L.marker([m.lat, m.lng], { icon: customIcon }).addTo(map);
                marker.on('click', () => {
                    openProfileModal(m);
                });
                markers.push(marker);
            });

            const group = new L.featureGroup(markers);
            map.fitBounds(group.getBounds().pad(0.2));
        }

        const teamGrid = document.getElementById('teamGrid');
        team.forEach((m, i) => {
            const div = document.createElement('div');
            div.className = 'team-card reveal';
            div.style.transitionDelay = `${(i % 4) * 0.1}s`;
            
            const avatarContent = renderAvatarContent(m.name, m.avatar);

            div.innerHTML = `
                <div class="avatar-wrapper">
                    <div class="initial-avatar">${avatarContent}</div>
                    <div class="flag-badge">${m.flags}</div>
                </div>
                <h3>${m.name}</h3>
                <p>${m.desc}</p>
            `;
            
            div.addEventListener('click', () => {
                openProfileModal(m);
            });
            teamGrid.appendChild(div);
        });

        window.onload = () => {
            initMap();
            drawCard(); // Initial card render
        };

        const letterModal = document.getElementById('letterModal');
        document.getElementById('openLetter').addEventListener('click', () => letterModal.classList.add('active'));
        document.getElementById('closeLetterModal').addEventListener('click', () => letterModal.classList.remove('active'));
        
        document.getElementById('closeProfileModal').addEventListener('click', () => profileModal.classList.remove('active'));
        profileModal.addEventListener('click', (e) => { if(e.target === profileModal) profileModal.classList.remove('active'); });

        const magneticElements = document.querySelectorAll('.magnetic');
        magneticElements.forEach(el => {
            el.addEventListener('mousemove', function(e) {
                const pos = el.getBoundingClientRect();
                const x = e.clientX - pos.left - pos.width / 2;
                const y = e.clientY - pos.top - pos.height / 2;
                el.style.transform = `translate(${x * 0.3}px, ${y * 0.3}px)`;
            });
            el.addEventListener('mouseleave', function() { el.style.transform = `translate(0, 0)`; });
        });

        const cursor = document.getElementById('cursor');
        document.addEventListener('mousemove', (e) => {
            cursor.style.left = e.clientX + 'px'; 
            cursor.style.top = e.clientY + 'px';
        });

        document.querySelectorAll('a, button, .team-card, .quiz-btn, .bento-item, .social-link, .envelope-trigger, .map-avatar-marker').forEach(el => {
            el.addEventListener('mouseenter', () => { cursor.style.width = '50px'; cursor.style.height = '50px'; });
            el.addEventListener('mouseleave', () => { cursor.style.width = '20px'; cursor.style.height = '20px'; });
        });

        const logo = document.getElementById('logo');
        logo.addEventListener('click', (e) => {
            e.preventDefault();
            logo.classList.add('spin');
            rain(20);
            setTimeout(() => logo.classList.remove('spin'), 800);
        });

        const themeToggle = document.getElementById('themeToggle');
        const body = document.body;
        const updateThemeIcon = (isDark) => {
            themeToggle.innerHTML = `<i data-lucide="${isDark ? 'moon' : 'sun'}"></i>`;
            lucide.createIcons();
            setTimeout(drawCard, 100); // Redraw card for theme context if needed
        };
        themeToggle.addEventListener('click', () => {
            const isDark = body.classList.toggle('dark-mode');
            localStorage.setItem('neact-theme', isDark ? 'dark' : 'light');
            updateThemeIcon(isDark);
        });

        const menuToggle = document.getElementById('menuToggle');
        const navLinks = document.getElementById('navLinks');
        menuToggle.addEventListener('click', () => {
            navLinks.classList.toggle('active');
            const icon = navLinks.classList.contains('active') ? 'x' : 'menu';
            menuToggle.innerHTML = `<i data-lucide="${icon}" size="32"></i>`;
            lucide.createIcons();
        });

        const sceneObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) entry.target.classList.add('active');
            });
        }, { threshold: 0.5 });
        document.querySelectorAll('.scene').forEach(scene => sceneObserver.observe(scene));

        const revealObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => { if (entry.isIntersecting) entry.target.classList.add('active'); });
        }, { threshold: 0.1, rootMargin: '0px 0px -50px 0px' });
        document.querySelectorAll('.reveal').forEach(el => revealObserver.observe(el));

        function rain(count = 25) {
            const emojis = ['ü•ê', '‚òï', '‚ú®'];
            for(let i=0; i<count; i++) {
                setTimeout(() => {
                    const el = document.createElement('div');
                    el.className = 'rain-item';
                    el.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                    el.style.left = Math.random() * 100 + 'vw';
                    document.body.appendChild(el);
                    setTimeout(() => { el.style.opacity = '0'; setTimeout(() => el.remove(), 1000); }, 4000);
                }, i * 80);
            }
        }

        window.addEventListener('scroll', () => {
            const history = document.querySelector('.story-container');
            if(!history) return;
            const scrollPos = window.scrollY - history.offsetTop;
            const total = history.offsetHeight - window.innerHeight;
            const percent = Math.min(Math.max((scrollPos / total) * 100, 0), 100);
            const bar = document.getElementById('storyBar');
            if(bar) bar.style.top = `calc(${percent}% - 60px)`;
        });
    </script>
</body>
</html>
